@model List<SoftfyWeb.Modelos.Dtos.PlanDto>

@{
    ViewData["Title"] = "Seleccionar Plan";
}

<h2 class="text-white text-center my-4">@ViewData["Title"]</h2>

<form asp-action="ActivarSuscripcion" method="post">
    <div class="row justify-content-center gap-4">
        @foreach (var plan in Model)
        {
            <div class="col-md-3">
                <label class="card plan-card text-center" style="cursor:pointer; background:linear-gradient(135deg, #1f1f2e, #29293d); border-radius:15px; box-shadow:0 6px 15px rgba(0,0,0,0.6); transition:transform 0.3s, box-shadow 0.3s;">
                    <input type="radio" name="planId" value="@plan.Id" required class="d-none plan-radio" />
                    <div class="card-body">
                        <h5 class="card-title" style="color:#00ffff; font-size:1.5rem; font-weight:bold;">
                            ⭐ @plan.Nombre
                        </h5>
                        <h6 class="card-subtitle mb-3" style="color:#00ced1; font-size:1.3rem;">
                            @plan.Precio.ToString("C")
                        </h6>
                        <p class="text-light" style="font-size:1rem;">
                            <strong>Incluye hasta:</strong> @plan.MaxUsuarios usuario(s)
                        </p>

                        <!-- Descripción persuasiva -->
                        <div style="background-color:#111827; padding:12px; border-radius:10px; color:#d1f7ff; font-size:0.95rem; font-weight:500; box-shadow:inset 0 0 8px rgba(0,255,255,0.4); margin-top:10px;">
                            @if (plan.MaxUsuarios == 1)
                            {
                                <p><strong>¡Ideal para ti!</strong> Disfruta de <span style="color:#00ffff;">guardar</span> y <span style="color:#00ffff;">descargar</span> tus canciones favoritas <br /> ¡Por solo <strong>@plan.Precio.ToString("C")</strong>!</p>
                            }
                            else
                            {
                                <p><strong>¡Más beneficios!</strong> Disfruta este plan <strong>@plan.Nombre</strong> que te permite <span style="color:#00ffff;">asociar hasta @plan.MaxUsuarios usuarios</span> <br /> ¡Todo al módico precio de <strong>@plan.Precio.ToString("C")</strong>!</p>
                            }
                        </div>

                        <!-- Botón visual dentro de la tarjeta -->
                        <button type="button" class="btn btn-outline-light mt-3" style="border-color:#00ffff; color:#00ffff; font-weight:bold; transition:0.3s;" onclick="selectPlan(this)">
                            Elegir este plan
                        </button>
                    </div>
                </label>
            </div>
        }
    </div>

    <div class="text-center mt-5">
        <button type="submit" class="btn btn-lg px-5" style="background-color:#00ffff; color:#111827; font-weight:bold; font-size:1.2rem; box-shadow:0 4px 15px rgba(0,255,255,0.5); transition:0.3s;">
            Activar Suscripción
        </button>
    </div>
</form>

@section Scripts {
    <script>
        document.querySelectorAll('.plan-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.plan-card').forEach(c => {
                    c.style.border = '2px solid transparent';
                    c.style.transform = 'scale(1)';
                    c.style.boxShadow = '0 6px 15px rgba(0,0,0,0.6)';
                });
                card.style.border = '2px solid #00ffff';
                card.style.transform = 'scale(1.05)';
                card.style.boxShadow = '0 8px 20px rgba(0,255,255,0.5)';
                card.querySelector('.plan-radio').checked = true;
            });
        });

        function selectPlan(button) {
            button.closest('.plan-card').click();
        }
    </script>
}
